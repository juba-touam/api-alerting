<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>ğŸ” Simulation dâ€™une attaque par force brute sur un systÃ¨me dâ€™authentification keycloack</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1 class="mb-4 text-primary">ğŸ” Simulation dâ€™une attaque par force brute sur un systÃ¨me dâ€™authentification kecloack</h1>

    <div class="mb-3">
        <label for="count" class="form-label">Nombre de requÃªtes</label>
        <input type="number" id="count" class="form-control" value="10">
    </div>

    <div class="mb-3">
        <label for="pause" class="form-label">Pause entre requÃªtes (secondes)</label>
        <input type="number" id="pause" class="form-control" step="0.1" value="0">
    </div>

    <div class="btn-group">
        <button class="btn btn-primary" onclick="lancerSimulation()">â–¶ï¸ Lancer</button>
        <button class="btn btn-danger" onclick="stopSimulation()">â›” ArrÃªter</button>
    </div>

    <div id="resultat" class="mt-4">En attente de lancement...</div>
</div>

<script>
    let statusInterval;

    function lancerSimulation() {
        const count = document.getElementById("count").value;
        const pause = document.getElementById("pause").value;
        document.getElementById("resultat").innerHTML = "â³ Simulation en cours...";

        fetch(`/simulate?count=${count}&pause=${pause}`)
            .then(() => {
                statusInterval = setInterval(checkStatus, 1000);
            });
    }

    function stopSimulation() {
        fetch("/stop", { method: "POST" })
            .then(() => {
                clearInterval(statusInterval);
                document.getElementById("resultat").innerHTML = "â›” Simulation arrÃªtÃ©e.";
            });
    }

    function checkStatus() {
        fetch("/status")
            .then(res => res.json())
            .then(data => {
                if (!data.running) {
                    clearInterval(statusInterval);
                    document.getElementById("resultat").innerHTML = "âœ… Simulation terminÃ©e.";
                }
            });
    }
</script>
</body>
</html>
